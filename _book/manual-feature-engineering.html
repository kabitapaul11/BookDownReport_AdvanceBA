<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Manual Feature Engineering: | Home Credit Default Risk - Final Report</title>
  <meta name="description" content="Chapter 9 Manual Feature Engineering: | Home Credit Default Risk - Final Report" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Manual Feature Engineering: | Home Credit Default Risk - Final Report" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chapter 9 Manual Feature Engineering: | Home Credit Default Risk - Final Report" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Manual Feature Engineering: | Home Credit Default Risk - Final Report" />
  
  <meta name="twitter:description" content="Chapter 9 Manual Feature Engineering: | Home Credit Default Risk - Final Report" />
  

<meta name="author" content="Team Members - Ibrokhim Sadikov - Kabita Paul - Namrata Tathe - Rittika Mitra - Jiamin Lei" />


<meta name="date" content="2019-11-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="confusion-matrix.html"/>
<link rel="next" href="references.html"/>
<script src="assets/jquery-2.2.3/jquery.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About Home Credit</a></li>
<li class="chapter" data-level="2" data-path="background-research.html"><a href="background-research.html"><i class="fa fa-check"></i><b>2</b> Background Research</a></li>
<li class="chapter" data-level="3" data-path="objective.html"><a href="objective.html"><i class="fa fa-check"></i><b>3</b> Objective</a></li>
<li class="chapter" data-level="4" data-path="data-overview.html"><a href="data-overview.html"><i class="fa fa-check"></i><b>4</b> Data Overview</a></li>
<li class="chapter" data-level="5" data-path="exploration-of-data.html"><a href="exploration-of-data.html"><i class="fa fa-check"></i><b>5</b> Exploration of Data</a><ul>
<li class="chapter" data-level="5.1" data-path="target.html"><a href="target.html"><i class="fa fa-check"></i><b>5.1</b> Target</a></li>
<li class="chapter" data-level="5.2" data-path="independent-variables.html"><a href="independent-variables.html"><i class="fa fa-check"></i><b>5.2</b> Independent Variables</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="challenges.html"><a href="challenges.html"><i class="fa fa-check"></i><b>6</b> Challenges:</a><ul>
<li class="chapter" data-level="6.1" data-path="too-many-attributes.html"><a href="too-many-attributes.html"><i class="fa fa-check"></i><b>6.1</b> Too many attributes:</a></li>
<li class="chapter" data-level="6.2" data-path="dealing-with-missing-values.html"><a href="dealing-with-missing-values.html"><i class="fa fa-check"></i><b>6.2</b> Dealing with Missing values:</a></li>
<li class="chapter" data-level="6.3" data-path="imbalanced-data.html"><a href="imbalanced-data.html"><i class="fa fa-check"></i><b>6.3</b> Imbalanced Data:</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="methodology.html"><a href="methodology.html"><i class="fa fa-check"></i><b>7</b> Methodology:</a><ul>
<li class="chapter" data-level="7.1" data-path="supervised.html"><a href="supervised.html"><i class="fa fa-check"></i><b>7.1</b> Supervised:</a></li>
<li class="chapter" data-level="7.2" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>7.2</b> Classification:</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="metrics.html"><a href="metrics.html"><i class="fa fa-check"></i><b>8</b> Metrics</a><ul>
<li class="chapter" data-level="8.1" data-path="roc.html"><a href="roc.html"><i class="fa fa-check"></i><b>8.1</b> ROC</a></li>
<li class="chapter" data-level="8.2" data-path="confusion-matrix.html"><a href="confusion-matrix.html"><i class="fa fa-check"></i><b>8.2</b> Confusion Matrix</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="manual-feature-engineering.html"><a href="manual-feature-engineering.html"><i class="fa fa-check"></i><b>9</b> Manual Feature Engineering:</a></li>
<li class="chapter" data-level="10" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>10</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Home Credit Default Risk - Final Report</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="manual-feature-engineering" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Manual Feature Engineering:</h1>
<p>For improving accuracy of the model, we need to include information from other data frames as much as possible. We will include features from Bureau and Bureau Balance data. Manual feature engineering is a tedious process and often rely on domain specific knowledge. Since we have limited knowledge in credit underwriting, we will try to collect as much data as possible as later do feature selection to filter out important variables.
The information we plan to include from other tables are.</p>
<ol style="list-style-type: decimal">
<li><p>Counts of clientsâ€™ previous loan as per bureau record.</p></li>
<li><p>Mean, max, minimum, sum for days_credit , days_overdue etc.</p></li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(dplyr)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">bureau &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Data/bureau.csv&quot;</span>)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">head</span>(bureau)</a></code></pre></div>
<pre><code>##   SK_ID_CURR SK_ID_BUREAU CREDIT_ACTIVE CREDIT_CURRENCY DAYS_CREDIT
## 1     215354      5714462        Closed      currency 1        -497
## 2     215354      5714463        Active      currency 1        -208
## 3     215354      5714464        Active      currency 1        -203
## 4     215354      5714465        Active      currency 1        -203
## 5     215354      5714466        Active      currency 1        -629
## 6     215354      5714467        Active      currency 1        -273
##   CREDIT_DAY_OVERDUE DAYS_CREDIT_ENDDATE DAYS_ENDDATE_FACT
## 1                  0                -153              -153
## 2                  0                1075                NA
## 3                  0                 528                NA
## 4                  0                  NA                NA
## 5                  0                1197                NA
## 6                  0               27460                NA
##   AMT_CREDIT_MAX_OVERDUE CNT_CREDIT_PROLONG AMT_CREDIT_SUM
## 1                     NA                  0        91323.0
## 2                     NA                  0       225000.0
## 3                     NA                  0       464323.5
## 4                     NA                  0        90000.0
## 5                77674.5                  0      2700000.0
## 6                    0.0                  0       180000.0
##   AMT_CREDIT_SUM_DEBT AMT_CREDIT_SUM_LIMIT AMT_CREDIT_SUM_OVERDUE
## 1                0.00                   NA                      0
## 2           171342.00                   NA                      0
## 3                  NA                   NA                      0
## 4                  NA                   NA                      0
## 5                  NA                   NA                      0
## 6            71017.38             108982.6                      0
##       CREDIT_TYPE DAYS_CREDIT_UPDATE AMT_ANNUITY
## 1 Consumer credit               -131          NA
## 2     Credit card                -20          NA
## 3 Consumer credit                -16          NA
## 4     Credit card                -16          NA
## 5 Consumer credit                -21          NA
## 6     Credit card                -31          NA</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">bureau_balance &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Data/bureau_balance.csv&quot;</span>)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">#head(bureau_balance)</span></a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">library</span>(reshape2)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co"># aggregating Bureau Balance table</span></a>
<a class="sourceLine" id="cb8-3" title="3">bureau_balance_aggr &lt;-<span class="st"> </span>bureau_balance <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(SK_ID_BUREAU) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="st">   </span><span class="kw">summarize</span>(<span class="dt">MONTHS_BALANCE =</span> <span class="kw">min</span>(MONTHS_BALANCE))</a>
<a class="sourceLine" id="cb8-5" title="5">bureau_status_grp &lt;-<span class="st"> </span>bureau_balance <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(SK_ID_BUREAU, STATUS) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>())</a>
<a class="sourceLine" id="cb8-7" title="7"></a>
<a class="sourceLine" id="cb8-8" title="8">bureau_status_grp &lt;-<span class="st"> </span><span class="kw">dcast</span>(bureau_status_grp, SK_ID_BUREAU<span class="op">~</span>STATUS, <span class="dt">fill=</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## Using count as value column: use value.var to override.</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">bureau_status_grp &lt;-<span class="st"> </span>bureau_status_grp <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Status_X =</span> X, <span class="dt">Status_C=</span> C, <span class="dt">Status_0 =</span> <span class="st">`</span><span class="dt">0</span><span class="st">`</span>)  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="st">   </span><span class="kw">select</span>(SK_ID_BUREAU, Status_X, Status_C, Status_<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb10-3" title="3"> </a>
<a class="sourceLine" id="cb10-4" title="4">bureau_balance_aggr &lt;-<span class="st"> </span>bureau_balance_aggr <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(bureau_status_grp, <span class="dt">by=</span> <span class="st">&quot;SK_ID_BUREAU&quot;</span>)</a>
<a class="sourceLine" id="cb10-5" title="5">bureau_balance_aggr</a></code></pre></div>
<pre><code>## # A tibble: 817,395 x 5
##    SK_ID_BUREAU MONTHS_BALANCE Status_X Status_C Status_0
##           &lt;int&gt;          &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
##  1      5001709            -96       11       86        0
##  2      5001710            -82       30       48        5
##  3      5001711             -3        1        0        3
##  4      5001712            -18        0        9       10
##  5      5001713            -21       22        0        0
##  6      5001714            -14       15        0        0
##  7      5001715            -59       60        0        0
##  8      5001716            -85       20       39       27
##  9      5001717            -21        0        5       17
## 10      5001718            -38       10        3       24
## # ... with 817,385 more rows</code></pre>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="confusion-matrix.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/08-feature-engineering.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["home-credit.pdf", "home-credit.epub"],
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

</body>

</html>
